!function(t,e,n){"use strict";angular.module("angular-tour",["angular-tour.tour"]),angular.module("angular-tour.tour",[]).constant("tourConfig",{placement:"top",animation:!0,nextLabel:"Next",scrollSpeed:500,margin:28,backDrop:!1,useSourceScope:!1,containerElement:"body"}).controller("TourController",["$scope","orderedList",function(t,e){var n=this,r=n.steps=e();n.postTourCallback=angular.noop,n.postStepCallback=angular.noop,n.showStepCallback=angular.noop,n.currentStep=-1,t.$watch(function(){return n.currentStep},function(t){n.select(t)}),n.select=function(t){if(angular.isNumber(t)){n.unselectAllSteps();var e=r.get(t);e&&(e.ttOpen=!0),n.currentStep!==t&&(n.currentStep=t),n.currentStep>-1&&n.showStepCallback(),t>=r.getCount()&&n.postTourCallback(!0),n.postStepCallback()}},n.addStep=function(t){angular.isNumber(t.index)&&!isNaN(t.index)?r.set(t.index,t):r.push(t)},n.unselectAllSteps=function(){r.forEach(function(t){t.ttOpen=!1})},n.cancelTour=function(){n.unselectAllSteps(),n.postTourCallback(!1)},t.openTour=function(){var t=n.currentStep>=r.getCount()||n.currentStep<0?0:n.currentStep;n.select(t)},t.closeTour=function(){n.cancelTour()}}]).directive("tour",["$parse","$timeout","tourConfig",function(t,e,n){return{controller:"TourController",restrict:"EA",scope:!0,link:function(r,o,a,i){if(!angular.isDefined(a.step))throw"The <tour> directive requires a `step` attribute to bind the current step to.";var u=t(a.step),l=!1;r.$watch(a.step,function(t){i.currentStep=t}),i.postTourCallback=function(t){angular.element(".tour-backdrop").remove(),l=!1,angular.element(".tour-element-active").removeClass("tour-element-active"),t&&angular.isDefined(a.tourComplete)&&r.$parent.$eval(a.tourComplete),angular.isDefined(a.postTour)&&r.$parent.$eval(a.postTour)},i.postStepCallback=function(){angular.isDefined(a.postStep)&&r.$parent.$eval(a.postStep)},i.showStepCallback=function(){n.backDrop&&(angular.element(n.containerElement).append(angular.element('<div class="tour-backdrop"></div>')),e(function(){$(".tour-backdrop").remove(),angular.element('<div class="tour-backdrop"></div>').insertBefore(".tour-tip")},1e3),l=!0)},r.setCurrentStep=function(t){u.assign(r.$parent,t),i.currentStep=t},r.getCurrentStep=function(){return i.currentStep}}}}]).directive("tourtip",["$window","$compile","$interpolate","$timeout","tourConfig","debounce",function(e,r,o,a,i,u){var l=(o.startSymbol(),o.endSymbol(),"<div tour-popup></div>");return{require:"^tour",restrict:"EA",scope:!0,link:function(o,c,s,p){function f(){var t=o.ttElement?angular.element(o.ttElement):c,e=o;return t===c||o.ttSourceScope||(e=t.scope()),e}function m(e,n){var r,a,i=0,u=e[0].getBoundingClientRect(),l=u.top+t.pageYOffset,c=0;if(n&&n[0]){l=l-n[0].getBoundingClientRect().top+n[0].scrollTop,"fixed"===n.css("position")&&(c=n[0].getBoundingClientRect().left);var s=n[0].getBoundingClientRect().width;v.width()+u.width>s&&(r=s-u.left+o.ttMargin)}var p=v.width(),f=v.height();switch(o.ttPlacement){case"right":var m=u.left-c+u.width+o.ttMargin+o.offsetHorizontal;a={top:l+o.offsetVertical,left:m>0?m:i};break;case"bottom":var m=u.left-c+o.offsetHorizontal;a={top:l+u.height+o.ttMargin+o.offsetVertical,left:m>0?m:i};break;case"center":var m=u.left-c+.5*(u.width-p)+o.offsetHorizontal;a={top:l+.5*(u.height-f)+o.ttMargin+o.offsetVertical,left:m>0?m:i};break;case"center-top":var m=u.left-c+.5*(u.width-p)+o.offsetHorizontal;a={top:l+.1*(u.height-f)+o.ttMargin+o.offsetVertical,left:m>0?m:i};break;case"left":var m=u.left-c-p-o.ttMargin+o.offsetHorizontal;a={top:l+o.offsetVertical,left:m>0?m:i,right:r};break;default:var m=u.left-c+o.offsetHorizontal;a={top:l-f-o.ttMargin+o.offsetVertical,left:m>0?m:i}}return a.top+="px",a.left+="px",a}function d(){if(o.ttContent){o.ttAnimation?v.fadeIn():v.css({display:"block"});var t=o.ttElement?angular.element(o.ttElement):c;if(null==t||0===t.length)throw"Target element could not be found. Selector: "+o.ttElement;angular.element(o.ttContainerElement).append(v);var r=function(){var e="body"===o.ttContainerElement?n:angular.element(o.ttContainerElement),r=m(t,e);v.css(r);var a=parseInt(r.top),u=parseInt(r.left);scrollTo(v,o.ttContainerElement,-150,-300,i.scrollSpeed,a,u)};if(i.backDrop&&g(t),angular.element(e).bind("resize."+o.$id,u(r,50)),r(),o.onStepShow){var l=f();a(function(){l.$eval(o.onStepShow)},300)}}}function h(){v.detach(),angular.element(e).unbind("resize."+o.$id)}function g(t){angular.element(".tour-element-active").removeClass("tour-element-active"),o.centered||t.addClass("tour-element-active")}s.$observe("tourtip",function(t){o.ttContent=t}),s.$observe("tourtipTitle",function(t){o.ttTitle=t}),s.$observe("tourtipPlacement",function(t){o.ttPlacement=(t||i.placement).toLowerCase().trim(),o.centered=0===o.ttPlacement.indexOf("center")}),s.$observe("tourtipNextLabel",function(t){o.ttNextLabel=t||i.nextLabel}),s.$observe("tourtipContainerElement",function(t){o.ttContainerElement=t||i.containerElement}),s.$observe("tourtipMargin",function(t){o.ttMargin=parseInt(t,10)||i.margin}),s.$observe("tourtipOffsetVertical",function(t){o.offsetVertical=parseInt(t,10)||0}),s.$observe("tourtipOffsetHorizontal",function(t){o.offsetHorizontal=parseInt(t,10)||0}),s.$observe("onShow",function(t){o.onStepShow=t||null}),s.$observe("onProceed",function(t){o.onStepProceed=t||null}),s.$observe("tourtipElement",function(t){o.ttElement=t||null}),s.$observe("useSourceScope",function(t){o.ttSourceScope=t?"true"===t:i.useSourceScope}),o.ttNextLabel=i.nextLabel,o.ttContainerElement=i.containerElement,o.ttPlacement=i.placement.toLowerCase().trim(),o.centered=!1,o.ttMargin=i.margin,o.offsetHorizontal=0,o.offsetVertical=0,o.ttSourceScope=i.useSourceScope,o.ttOpen=!1,o.ttAnimation=i.animation,o.index=parseInt(s.tourtipStep,10);var v=r(l)(o);p.addStep(o),a(function(){o.$watch("ttOpen",function(t){t?d():h()})},500),o.$on("$destroy",function(){angular.element(e).unbind("resize."+o.$id),v.remove(),v=null}),o.proceed=function(){if(o.onStepProceed){var t=f();a(function(){t.$eval(o.onStepProceed)},100)}o.setCurrentStep(o.getCurrentStep()+1)}}}}]).directive("tourPopup",function(){return{replace:!0,templateUrl:"components/shared/widgets/coreStepTemplate.html",scope:!0,restrict:"EA",link:function(t,e,n){}}}).factory("orderedList",function(){var t=function(){this.map={},this._array=[]};t.prototype.set=function(t,e){if(angular.isNumber(t))if(t in this.map)this.map[t]=e;else{if(t<this._array.length){var n=t-1>0?t-1:0;this._array.splice(n,0,t)}else this._array.push(t);this.map[t]=e,this._array.sort(function(t,e){return t-e})}},t.prototype.indexOf=function(t){for(var e in this.map)if(this.map.hasOwnProperty(e)&&this.map[e]===t)return Number(e)},t.prototype.push=function(t){var e=this._array[this._array.length-1]+1||0;this._array.push(e),this.map[e]=t,this._array.sort(function(t,e){return t-e})},t.prototype.remove=function(t){var e=this._array.indexOf(t);if(-1===e)throw new Error("key does not exist");this._array.splice(e,1),delete this.map[t]},t.prototype.get=function(t){return this.map[t]},t.prototype.getCount=function(){return this._array.length},t.prototype.forEach=function(t){for(var e,n,r=0;r<this._array.length;r++)e=this._array[r],n=this.map[e],t(n,e)},t.prototype.first=function(){var t,e;return t=this._array[0],e=this.map[t]};var e=function(){return new t};return e}).factory("debounce",["$timeout","$q",function(t,e){return function(n,r,o){var a,i=e.defer();return function(){var u=this,l=arguments,c=function(){a=null,o||(i.resolve(n.apply(u,l)),i=e.defer())},s=o&&!a;return a&&t.cancel(a),a=t(c,r),s&&(i.resolve(n.apply(u,l)),i=e.defer()),i.promise}}}])}(window,document);